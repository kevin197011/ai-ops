# 链接管理分页功能说明

## 功能概述

为管理后台的链接管理页面添加了完整的分页功能，包括：

- **服务端分页**：支持大量链接数据的高效展示
- **每页条数选择**：可选择每页显示 5、10、20、50 条记录
- **分类过滤**：按分类筛选链接，支持分页
- **友好的分页导航**：包含页码、上一页/下一页按钮
- **分页信息显示**：显示当前页范围和总记录数

## 技术实现

### 后端实现 (app.rb)

1. **修改了 `/admin/links` 路由**，增加分页逻辑：
   - 支持 `page`、`per_page`、`category` 参数
   - 使用 SQL `LIMIT` 和 `OFFSET` 实现分页
   - 计算总页数、当前页等分页信息

2. **新增辅助方法 `build_pagination_url`**：
   - 构建分页链接 URL
   - 保持过滤条件和每页条数设置

### 前端实现 (views/admin_links.erb)

1. **增强过滤器区域**：
   - 保持分类过滤功能
   - 新增每页条数选择器
   - 选择器状态与当前URL参数同步

2. **分页导航组件**：
   - 智能页码显示（最多显示5个页码）
   - 支持首页/末页跳转
   - 上一页/下一页按钮
   - 当前页高亮显示

3. **分页信息展示**：
   - 显示当前页范围："显示第 X - Y 条，共 Z 条记录"

4. **JavaScript 功能**：
   - `filterByCategory()`: 分类过滤时跳转到第一页
   - `changePerPage()`: 修改每页条数时跳转到第一页
   - 保持用户选择的过滤条件

## 使用方法

1. **访问链接管理页面**：
   - 登录管理后台：`http://localhost:4567/admin/login`
   - 导航到：链接管理

2. **使用分页功能**：
   - 点击页码直接跳转到指定页
   - 使用"上一页"/"下一页"按钮导航
   - 修改"每页显示"选择器调整每页条数
   - 使用"按分类过滤"筛选特定分类的链接

3. **URL 参数说明**：
   - `page`: 当前页码（默认为1）
   - `per_page`: 每页条数（默认为10，可选：5、10、20、50）
   - `category`: 分类过滤（可选）

## 示例 URL

- 第1页，每页10条：`/admin/links?page=1&per_page=10`
- 第2页，每页20条：`/admin/links?page=2&per_page=20`
- 筛选"监控系统"分类：`/admin/links?page=1&per_page=10&category=监控系统`

## 性能优化

- 使用数据库级别的分页（LIMIT/OFFSET）
- 只查询当前页需要的数据
- 总数查询优化，避免全表扫描
- 保持过滤条件的URL状态同步

## 兼容性

- 向后兼容原有的链接管理功能
- 不影响现有的增删改操作
- 编辑模式在分页后仍正常工作