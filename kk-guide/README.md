# è¿ç»´å¯¼èˆªç³»ç»Ÿ (KK Guide)

ä¸€ä¸ªåŸºäº Ruby Sinatra çš„è¿ç»´å¯¼èˆªç®¡ç†ç³»ç»Ÿï¼Œæä¾›å‰ç«¯å±•ç¤ºå’Œåå°ç®¡ç†åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **åˆ†ç±»ç®¡ç†**: æ”¯æŒè‡ªå®šä¹‰å¯¼èˆªåˆ†ç±»
- ğŸ”— **é“¾æ¥ç®¡ç†**: å®Œæ•´çš„CRUDæ“ä½œï¼Œæ”¯æŒå›¾æ ‡ã€æè¿°ã€æ’åº
- ğŸ¨ **ç¾è§‚ç•Œé¢**: ç°ä»£åŒ–çš„å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæµ…è‰²ä¸»é¢˜
- ğŸ” **åˆ†ç±»è¿‡æ»¤**: æ”¯æŒæŒ‰åˆ†ç±»ç­›é€‰é“¾æ¥
- âœï¸ **åœ¨çº¿ç¼–è¾‘**: æ”¯æŒåˆ†ç±»å’Œé“¾æ¥çš„åœ¨çº¿ç¼–è¾‘
- ğŸ”” **ç¾åŒ–æç¤º**: ç»Ÿä¸€çš„æ“ä½œåé¦ˆå’Œé€šçŸ¥ç³»ç»Ÿ
- ğŸ” **æƒé™ç®¡ç†**: å®‰å…¨çš„ç®¡ç†å‘˜è®¤è¯ç³»ç»Ÿ
- ğŸ³ **Dockeræ”¯æŒ**: å®Œæ•´çš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ

## æŠ€æœ¯æ ˆ

- **åç«¯**: Ruby + Sinatra
- **æ•°æ®åº“**: SQLite3
- **å‰ç«¯**: HTML + Tailwind CSS + JavaScript
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **åå‘ä»£ç†**: Nginx (å¯é€‰)

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½² (æ¨è)

#### å‰ç½®è¦æ±‚
- Docker
- Docker Compose

#### ä¸€é”®éƒ¨ç½²
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd kk-guide

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./docker-deploy.sh
```

éƒ¨ç½²è„šæœ¬æä¾›ä»¥ä¸‹é€‰é¡¹ï¼š
1. **ç®€åŒ–éƒ¨ç½²**: ä»…è¿è¡Œåº”ç”¨ (ç«¯å£ 4567)
2. **å®Œæ•´éƒ¨ç½²**: åº”ç”¨ + Nginx åå‘ä»£ç† (ç«¯å£ 80)
3. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
4. åœæ­¢æœåŠ¡
5. æ¸…ç†æ‰€æœ‰æ•°æ®

#### æ‰‹åŠ¨ Docker éƒ¨ç½²

**ç®€åŒ–ç‰ˆæœ¬ (ä»…åº”ç”¨)**:
```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose -f docker-compose.simple.yml up -d

# è®¿é—®åº”ç”¨
open http://localhost:4567
```

**å®Œæ•´ç‰ˆæœ¬ (åº”ç”¨ + Nginx)**:
```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# è®¿é—®åº”ç”¨
open http://localhost
```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘éƒ¨ç½²

#### å‰ç½®è¦æ±‚
- Ruby 2.6+
- Bundler

#### å®‰è£…æ­¥éª¤
```bash
# å®‰è£…ä¾èµ–
bundle install

# å¯åŠ¨åº”ç”¨
ruby app.rb

# è®¿é—®åº”ç”¨
open http://localhost:4567
```

## ä½¿ç”¨è¯´æ˜

### é»˜è®¤è´¦æˆ·
- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123

### è®¿é—®åœ°å€
- **å‰ç«¯å±•ç¤º**: `http://localhost:4567/`
- **ç®¡ç†åå°**: `http://localhost:4567/admin`

### ä¸»è¦åŠŸèƒ½

#### åˆ†ç±»ç®¡ç†
- æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤å¯¼èˆªåˆ†ç±»
- è®¾ç½®åˆ†ç±»æ’åºå’Œæè¿°
- æ”¯æŒåœ¨çº¿ç¼–è¾‘

#### é“¾æ¥ç®¡ç†
- æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤å¯¼èˆªé“¾æ¥
- æ”¯æŒ Emoji å›¾æ ‡é€‰æ‹©
- é“¾æ¥çŠ¶æ€åˆ‡æ¢ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
- æŒ‰åˆ†ç±»è¿‡æ»¤é“¾æ¥
- æ”¯æŒåœ¨çº¿ç¼–è¾‘

#### å‰ç«¯å±•ç¤º
- å“åº”å¼å¡ç‰‡å¸ƒå±€
- æŒ‰åˆ†ç±»ç»„ç»‡æ˜¾ç¤º
- ä»…æ˜¾ç¤ºå¯ç”¨çš„é“¾æ¥
- ç°ä»£åŒ–çš„è§†è§‰è®¾è®¡

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `RACK_ENV` | development | è¿è¡Œç¯å¢ƒ |
| `SESSION_SECRET` | è‡ªåŠ¨ç”Ÿæˆ | ä¼šè¯å¯†é’¥ |
| `DATABASE_PATH` | navigation.db | æ•°æ®åº“æ–‡ä»¶è·¯å¾„ |
| `TZ` | Asia/Shanghai | æ—¶åŒºè®¾ç½® |

### Docker é…ç½®

#### æ•°æ®æŒä¹…åŒ–
æ•°æ®åº“æ–‡ä»¶å­˜å‚¨åœ¨ `./data` ç›®å½•ä¸­ï¼Œé€šè¿‡ Docker volume æŒ‚è½½å®ç°æŒä¹…åŒ–ã€‚

#### ç«¯å£é…ç½®
- **ç®€åŒ–ç‰ˆ**: åº”ç”¨ç«¯å£ 4567
- **å®Œæ•´ç‰ˆ**: Nginx ç«¯å£ 80/443

#### è‡ªå®šä¹‰é…ç½®
å¯ä»¥é€šè¿‡ä¿®æ”¹ `.env` æ–‡ä»¶æ¥è‡ªå®šä¹‰é…ç½®ï¼š

```bash
# å¤åˆ¶ç¤ºä¾‹é…ç½®
cp .env.example .env

# ç¼–è¾‘é…ç½®
vim .env
```

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
kk-guide/
â”œâ”€â”€ app.rb                 # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ Gemfile               # Ruby ä¾èµ–
â”œâ”€â”€ views/                # è§†å›¾æ¨¡æ¿
â”‚   â”œâ”€â”€ layout.erb        # å‰ç«¯å¸ƒå±€
â”‚   â”œâ”€â”€ index.erb         # é¦–é¡µ
â”‚   â”œâ”€â”€ admin_layout.erb  # ç®¡ç†åå°å¸ƒå±€
â”‚   â”œâ”€â”€ admin_*.erb       # ç®¡ç†é¡µé¢
â”œâ”€â”€ docker-compose.yml    # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ Dockerfile           # Docker é•œåƒæ„å»º
â”œâ”€â”€ nginx/               # Nginx é…ç½®
â””â”€â”€ data/                # æ•°æ®ç›®å½•
```

### API æ¥å£

#### åˆ†ç±»ç®¡ç†
- `GET /admin/categories` - åˆ†ç±»åˆ—è¡¨é¡µé¢
- `POST /admin/categories` - åˆ›å»ºåˆ†ç±»
- `PUT /admin/categories/:id` - æ›´æ–°åˆ†ç±»
- `DELETE /admin/categories/:id` - åˆ é™¤åˆ†ç±»

#### é“¾æ¥ç®¡ç†
- `GET /admin/links` - é“¾æ¥åˆ—è¡¨é¡µé¢
- `POST /admin/links` - åˆ›å»ºé“¾æ¥
- `PUT /admin/links/:id` - æ›´æ–°é“¾æ¥
- `PUT /admin/links/:id/toggle` - åˆ‡æ¢é“¾æ¥çŠ¶æ€
- `DELETE /admin/links/:id` - åˆ é™¤é“¾æ¥

### æ•°æ®åº“ç»“æ„

#### categories è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| name | TEXT | åˆ†ç±»åç§° |
| description | TEXT | åˆ†ç±»æè¿° |
| sort_order | INTEGER | æ’åº |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ |

#### nav_links è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| title | TEXT | é“¾æ¥æ ‡é¢˜ |
| url | TEXT | é“¾æ¥åœ°å€ |
| description | TEXT | é“¾æ¥æè¿° |
| category_id | INTEGER | åˆ†ç±»ID |
| icon | TEXT | å›¾æ ‡ |
| sort_order | INTEGER | æ’åº |
| is_active | BOOLEAN | æ˜¯å¦å¯ç”¨ |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ |

## éƒ¨ç½²å»ºè®®

### ç”Ÿäº§ç¯å¢ƒ
1. ä½¿ç”¨å®Œæ•´çš„ Docker Compose é…ç½®
2. é…ç½® Nginx åå‘ä»£ç†
3. è®¾ç½® SSL è¯ä¹¦
4. å®šæœŸå¤‡ä»½æ•°æ®åº“æ–‡ä»¶
5. ç›‘æ§åº”ç”¨å¥åº·çŠ¶æ€

### å®‰å…¨å»ºè®®
1. ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
2. ä½¿ç”¨å¼ºéšæœºä¼šè¯å¯†é’¥
3. é…ç½®é˜²ç«å¢™è§„åˆ™
4. å®šæœŸæ›´æ–°ä¾èµ–åŒ…

### å¤‡ä»½ç­–ç•¥
```bash
# å¤‡ä»½æ•°æ®åº“
cp data/navigation.db backup/navigation_$(date +%Y%m%d_%H%M%S).db

# æ¢å¤æ•°æ®åº“
cp backup/navigation_20231201_120000.db data/navigation.db
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç«¯å£è¢«å ç”¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :4567

# åœæ­¢å ç”¨è¿›ç¨‹
kill -9 <PID>
```

#### 2. æ•°æ®åº“æƒé™é—®é¢˜
```bash
# æ£€æŸ¥æ•°æ®ç›®å½•æƒé™
ls -la data/

# ä¿®å¤æƒé™
chmod 755 data/
chmod 644 data/navigation.db
```

#### 3. Docker æ„å»ºå¤±è´¥
```bash
# æ¸…ç† Docker ç¼“å­˜
docker system prune -a

# é‡æ–°æ„å»º
docker-compose build --no-cache
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f navigation-app

# æŸ¥çœ‹ Nginx æ—¥å¿—
docker-compose logs -f nginx

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€çš„åˆ†ç±»å’Œé“¾æ¥ç®¡ç†åŠŸèƒ½
- å“åº”å¼å‰ç«¯ç•Œé¢
- Docker å®¹å™¨åŒ–æ”¯æŒ
- å®Œæ•´çš„ç®¡ç†åå°

## æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [FAQ](docs/FAQ.md)
2. æœç´¢ç°æœ‰çš„ [Issues](../../issues)
3. åˆ›å»ºæ–°çš„ Issue

---

**KK Guide Team** - è®©è¿ç»´å¯¼èˆªæ›´ç®€å•ï¼